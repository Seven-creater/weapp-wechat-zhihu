<!--pages/switch-identity/index.wxml-->
<view class="container">
  <!-- å½“å‰èº«ä»½ -->
  <view class="current-section">
    <text class="section-title">å½“å‰èº«ä»½</text>
    <view class="current-identity">
      <text class="badge-icon">{{currentTypeConfig.badge.icon}}</text>
      <view class="identity-info">
        <text class="identity-label">{{currentTypeConfig.label}}</text>
        <text class="identity-desc">{{currentTypeConfig.description}}</text>
      </view>
    </view>
  </view>

  <!-- é€‰æ‹©æ–°èº«ä»½ -->
  <view class="select-section">
    <text class="section-title">åˆ‡æ¢èº«ä»½</text>
    <view class="identity-list">
      <view 
        wx:for="{{allTypes}}" 
        wx:key="id"
        class="identity-item {{selectedType === item.id ? 'selected' : ''}} {{item.needCertification ? 'disabled' : ''}}"
        bindtap="selectType"
        data-type="{{item.id}}"
      >
        <view class="identity-header">
          <text class="badge-icon">{{item.badge.icon}}</text>
          <text class="identity-label">{{item.label}}</text>
          <text class="cert-tag" wx:if="{{item.needCertification}}">éœ€è®¤è¯</text>
          <text class="check-icon" wx:if="{{selectedType === item.id}}">âœ“</text>
        </view>
        <text class="identity-desc">{{item.description}}</text>
        
        <!-- åŠŸèƒ½åˆ—è¡¨ -->
        <view class="features-list">
          <text 
            wx:for="{{item.features}}" 
            wx:key="*this"
            wx:for-item="feature"
            class="feature-item"
          >
            {{feature}}
          </text>
        </view>
      </view>
    </view>
  </view>

  <!-- è¡¥å……ä¿¡æ¯ï¼ˆä¸“ä¸šç”¨æˆ·ï¼‰ -->
  <view class="profile-section" wx:if="{{showProfileFields}}">
    <text class="section-title">è¡¥å……ä¿¡æ¯{{selectedType === 'communityWorker' ? 'ï¼ˆå¿…å¡«ï¼‰' : 'ï¼ˆå¯é€‰ï¼‰'}}</text>
    
    <view class="form-item">
      <text class="label">ä¸ªäººç®€ä»‹</text>
      <textarea 
        class="textarea-input" 
        placeholder="ç®€å•ä»‹ç»ä¸€ä¸‹è‡ªå·±..."
        value="{{bio}}"
        bindinput="onBioInput"
        maxlength="200"
      ></textarea>
    </view>

    <!-- ğŸ”§ ç¤¾åŒºå·¥ä½œè€…å¿…é¡»å¡«å†™è®¤è¯ä¿¡æ¯ -->
    <view wx:if="{{selectedType === 'communityWorker'}}">
      <view 
        wx:for="{{selectedTypeConfig.profileFields}}" 
        wx:key="key"
        class="form-item"
      >
        <text class="label">{{item.label}} <text class="required" wx:if="{{item.required}}">*</text></text>
        <input 
          class="text-input" 
          placeholder="{{item.placeholder}}"
          bindinput="onCustomFieldInput"
          data-key="{{item.key}}"
          value="{{customFields[item.key]}}"
        />
      </view>
    </view>
  </view>

  <!-- æç¤ºä¿¡æ¯ -->
  <view class="tips-box">
    <text class="tip-icon">ğŸ’¡</text>
    <view class="tip-content">
      <text class="tip-title">æ¸©é¦¨æç¤º</text>
      <text class="tip-text">â€¢ ä¸åŒèº«ä»½æ‹¥æœ‰ä¸åŒçš„åŠŸèƒ½æƒé™</text>
      <text class="tip-text">â€¢ æ™®é€šç”¨æˆ·ã€è®¾è®¡è€…ã€æ–½å·¥æ–¹å¯éšæ—¶åˆ‡æ¢</text>
      <text class="tip-text">â€¢ ç¤¾åŒºå·¥ä½œè€…éœ€è¦ç®¡ç†å‘˜è®¤è¯å®¡æ ¸</text>
      <text class="tip-text">â€¢ ä¸ªäººç®€ä»‹ä¼šæ˜¾ç¤ºåœ¨æ‚¨çš„ä¸»é¡µä¸Š</text>
    </view>
  </view>

  <!-- ä¿å­˜æŒ‰é’® -->
  <view class="action-section">
    <button 
      class="save-btn {{selectedType !== currentType ? 'active' : ''}}" 
      bindtap="saveIdentity"
      disabled="{{selectedType === currentType}}"
    >
      {{selectedType === currentType ? 'å½“å‰èº«ä»½' : 'ç¡®è®¤åˆ‡æ¢'}}
    </button>
  </view>
</view>

