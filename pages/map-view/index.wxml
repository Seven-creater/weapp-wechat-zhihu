<view class="map-container">
  <map
    id="map"
    class="map-view"
    longitude="{{longitude}}"
    latitude="{{latitude}}"
    scale="{{scale}}"
    show-location="{{true}}"
    markers="{{markers}}"
    bindmarkertap="onMarkerTap"
    bindregionchange="onRegionChange"
    aria-label="路障地图，显示{{markers.length}}个路障点"
  ></map>

  <!-- 地图控制按钮 -->
  <view class="map-controls">
    <view 
      class="control-btn" 
      bindtap="centerToUser"
      aria-role="button"
      aria-label="定位到当前位置"
    >
      <text class="control-icon">📍</text>
    </view>
    <view 
      class="control-btn" 
      bindtap="refreshMarkers"
      aria-role="button"
      aria-label="刷新路障数据"
    >
      <text class="control-icon">🔄</text>
    </view>
  </view>

  <!-- 路障统计信息 -->
  <view class="stats-card" wx:if="{{markers.length > 0}}">
    <text class="stats-text">发现 {{markers.length}} 个路障</text>
  </view>

  <!-- 加载状态 -->
  <view class="loading-mask" wx:if="{{loading}}">
    <view class="loading-content">
      <image class="loading-icon" src="/images/loading.gif" aria-hidden="true"></image>
      <text class="loading-text">加载中...</text>
    </view>
  </view>

  <!-- 空状态 -->
  <view class="empty-state" wx:if="{{!loading && markers.length === 0}}">
    <text class="empty-icon">🗺️</text>
    <text class="empty-text">暂无路障数据</text>
    <text class="empty-hint">快去随手拍第一个路障吧！</text>
  </view>
</view>
