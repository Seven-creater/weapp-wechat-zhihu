<view class="notify-container">
  <!-- Top Tabs -->
  <view class="top-tabs">
    <view class="tab-item {{currentTab === 0 ? 'active' : ''}}" bindtap="onTabTap" data-index="{{0}}">消息</view>
    <view class="tab-item {{currentTab === 1 ? 'active' : ''}}" bindtap="onTabTap" data-index="{{1}}">私信</view>
  </view>

  <!-- Message List -->
  <scroll-view scroll-y class="message-list">
    
    <!-- Tab 0: Notifications (Likes, Comments, System) -->
    <block wx:if="{{currentTab === 0}}">
      <block wx:for="{{noticeItems}}" wx:key="key">
        <view class="message-item" bindtap="onNoticeTap" data-key="{{item.key}}">
          <view class="avatar-box {{item.className}}">
            <image class="avatar-icon" src="{{item.icon}}" />
          </view>
          <view class="message-content">
            <view class="message-header">
              <text class="sender-name">{{item.title}}</text>
              <text class="message-time">{{item.time}}</text>
            </view>
            <view class="message-preview">{{item.preview}}</view>
          </view>
          <view class="unread-dot" wx:if="{{item.unread > 0}}"></view>
        </view>
      </block>
      <view class="empty-state" wx:if="{{noticeItems.length === 0}}">
        <text>暂无通知</text>
      </view>
    </block>

    <!-- Tab 1: Chat Messages -->
    <block wx:if="{{currentTab === 1}}">
      <block wx:for="{{messages}}" wx:key="id">
        <view class="message-item" bindtap="onChatTap" data-id="{{item.id}}">
          <image class="user-avatar" src="{{item.avatar}}" />
          <view class="message-content">
            <view class="message-header">
              <view class="sender-name-wrapper">
                <user-name 
                  nickName="{{item.name}}" 
                  userType="{{item.userType}}"
                  inline="{{true}}"
                />
              </view>
              <text class="message-time">{{item.time}}</text>
            </view>
            <view class="message-preview">{{item.preview}}</view>
          </view>
          <view class="unread-badge" wx:if="{{item.unread > 0}}">{{item.unread}}</view>
        </view>
      </block>
      
      <view wx:if="{{messages.length === 0}}" class="empty-state">
        <text>暂无私信</text>
      </view>
    </block>

  </scroll-view>
  <view class="list-footer" wx:if="{{messageLoading || noticeLoading}}">
    <text class="footer-text">加载中...</text>
  </view>
  <view class="list-footer" wx:if="{{currentTab === 1 && !messageLoading && !messageHasMore && messages.length > 0}}">
    <text class="footer-text">没有更多了</text>
  </view>
</view>
