<!--pages/design/proposal/index.wxml-->
<view class="container">
  <!-- é—®é¢˜ä¿¡æ¯ -->
  <view wx:if="{{post}}" class="problem-section">
    <view class="section-title">éšœç¢é—®é¢˜</view>
    <view class="problem-card">
      <view class="problem-content">{{post.content}}</view>
      <view wx:if="{{post.images && post.images.length > 0}}" class="problem-images">
        <image 
          wx:for="{{post.images}}" 
          wx:key="index"
          class="problem-image"
          src="{{item}}" 
          mode="aspectFill"
        />
      </view>
      <view class="problem-info">
        <text class="info-item">ğŸ“ {{post.formattedAddress || post.address}}</text>
        <text class="info-item">ğŸ’° é¢„ç®—: Â¥{{post.priceEstimate || 0}}</text>
      </view>
    </view>
  </view>

  <!-- è®¾è®¡æ–¹æ¡ˆè¾“å…¥ -->
  <view class="proposal-section">
    <view class="section-title">è®¾è®¡æ–¹æ¡ˆ</view>
    <textarea
      class="proposal-input"
      placeholder="è¯·è¯¦ç»†æè¿°æ‚¨çš„è®¾è®¡æ–¹æ¡ˆ..."
      value="{{content}}"
      bindinput="onContentInput"
      maxlength="2000"
      auto-height
    />
    <view class="char-count">{{content.length}}/2000</view>
  </view>

  <!-- è®¾è®¡å›¾ä¸Šä¼  -->
  <view class="images-section">
    <view class="section-title">è®¾è®¡å›¾</view>
    <view class="images-grid">
      <view wx:for="{{images}}" wx:key="index" class="image-item">
        <image 
          class="image-preview" 
          src="{{item}}" 
          mode="aspectFill"
          bindtap="previewImage"
          data-src="{{item}}"
        />
        <view class="remove-btn" bindtap="removeImage" data-index="{{index}}">
          <text class="remove-icon">âœ•</text>
        </view>
      </view>
      
      <view wx:if="{{images.length < maxImages}}" class="add-image-btn" bindtap="chooseImage">
        <text class="add-icon">+</text>
        <text class="add-text">æ·»åŠ è®¾è®¡å›¾</text>
      </view>
    </view>
  </view>

  <!-- é¢„ç®—è°ƒæ•´ -->
  <view class="budget-section">
    <view class="section-title">é¢„ç®—è°ƒæ•´</view>
    <view class="budget-input-row">
      <text class="budget-label">è°ƒæ•´é‡‘é¢</text>
      <input 
        class="budget-input" 
        type="digit"
        placeholder="0"
        value="{{priceAdjustment}}"
        bindinput="onPriceInput"
      />
      <text class="budget-unit">å…ƒ</text>
    </view>
    <view class="budget-tip">æ­£æ•°è¡¨ç¤ºå¢åŠ ï¼Œè´Ÿæ•°è¡¨ç¤ºå‡å°‘</view>
    
    <textarea
      class="reason-input"
      placeholder="è¯·è¯´æ˜é¢„ç®—è°ƒæ•´çš„åŸå› ..."
      value="{{adjustmentReason}}"
      bindinput="onReasonInput"
      maxlength="500"
    />
  </view>

  <!-- æäº¤æŒ‰é’® -->
  <view class="submit-section">
    <button 
      class="submit-btn {{submitting ? 'disabled' : ''}}" 
      bindtap="submitProposal"
      disabled="{{submitting}}"
    >
      {{submitting ? 'æäº¤ä¸­...' : 'æäº¤è®¾è®¡æ–¹æ¡ˆ'}}
    </button>
  </view>
</view>



