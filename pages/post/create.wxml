<view class="create-post-container">
  <!-- 头部操作栏 -->
  <view class="header-bar">
    <view 
      class="cancel-btn" 
      bindtap="cancelPost"
      aria-role="button"
      aria-label="取消发布"
    >
      <text>取消</text>
    </view>
    <text class="title">发布帖子</text>
    <view 
      class="submit-btn {{content.trim().length >= 5 ? 'active' : ''}}" 
      bindtap="submitPost"
      aria-role="button"
      aria-label="{{content.trim().length >= 5 ? '发布帖子' : '内容不足5个字，无法发布'}}"
    >
      <text>发布</text>
    </view>
  </view>

  <!-- 内容编辑区域 -->
  <view class="editor-section">
    <!-- 帖子类型选择 -->
    <view class="type-selector">
      <text class="selector-label">帖子类型：</text>
      <view class="type-options">
        <view 
          class="type-option {{type === 'share' ? 'active' : ''}}" 
          bindtap="selectType" 
          data-type="share"
          aria-role="button"
          aria-label="分享类型，{{type === 'share' ? '已选择' : '未选择'}}"
        >
          <text>分享</text>
        </view>
        <view 
          class="type-option {{type === 'help' ? 'active' : ''}}" 
          bindtap="selectType" 
          data-type="help"
          aria-role="button"
          aria-label="求助类型，{{type === 'help' ? '已选择' : '未选择'}}"
        >
          <text>求助</text>
        </view>
        <view 
          class="type-option {{type === 'issue' ? 'active' : ''}}" 
          bindtap="selectType" 
          data-type="issue"
          aria-role="button"
          aria-label="路障反馈类型，{{type === 'issue' ? '已选择' : '未选择'}}"
        >
          <text>路障反馈</text>
        </view>
      </view>
    </view>

    <!-- 内容输入框 -->
    <view class="content-editor">
      <textarea 
        class="content-input" 
        placeholder="分享你的无障碍经验、求助问题或路障反馈..." 
        value="{{content}}" 
        bindinput="onContentInput"
        maxlength="500"
        show-confirm-bar="false"
        aria-label="帖子内容输入框"
      ></textarea>
      <view class="word-count">
        <text class="count-text">{{content.length}}/500</text>
      </view>
    </view>

    <!-- 图片上传区域 -->
    <view class="image-upload-section">
      <view class="upload-header">
        <text class="upload-title">添加图片（{{images.length}}/9）</text>
        <text class="upload-tip">最多可上传9张图片</text>
      </view>
      
      <view class="image-list">
        <!-- 已上传的图片 -->
        <view 
          class="image-item" 
          wx:for="{{images}}" 
          wx:key="index"
          aria-role="button"
          aria-label="图片{{index + 1}}，点击预览"
        >
          <image
            class="uploaded-image"
            src="{{item.path || item}}"
            mode="aspectFill"
            bindtap="previewImage"
            data-src="{{item.path || item}}"
          ></image>
          <view 
            class="remove-btn" 
            bindtap="removeImage" 
            data-index="{{index}}"
            aria-role="button"
            aria-label="删除图片{{index + 1}}"
          >
            <text class="remove-icon" aria-hidden="true">×</text>
          </view>
        </view>
        
        <!-- 添加图片按钮 -->
        <view 
          class="add-image-btn" 
          wx:if="{{images.length < 9}}" 
          bindtap="chooseImage"
          aria-role="button"
          aria-label="添加图片，已上传{{images.length}}张，还可上传{{9 - images.length}}张"
        >
          <image class="add-icon" src="/images/add-image.png" aria-hidden="true"></image>
          <text class="add-text">添加图片</text>
        </view>
      </view>
    </view>
  </view>

  <!-- 底部提示 -->
  <view class="footer-tips">
    <text class="tip-text">
      • 请确保内容真实有效，遵守社区规范
    </text>
    <text class="tip-text">
      • 分享无障碍经验，帮助更多有需要的人
    </text>
    <text class="tip-text">
      • 求助时请尽量详细描述问题
    </text>
  </view>

  <!-- 清空内容按钮 -->
  <view 
    class="clear-btn" 
    bindtap="clearContent"
    wx:if="{{content || images.length > 0}}"
    aria-role="button"
    aria-label="清空已输入的内容和图片"
  >
    <image class="clear-icon" src="/images/clear.png" aria-hidden="true"></image>
    <text class="clear-text">清空内容</text>
  </view>

  <!-- 提交状态遮罩 -->
  <view class="submit-mask" wx:if="{{submitting}}">
    <view class="loading-content">
      <image class="loading-icon" src="/images/loading.gif" aria-hidden="true"></image>
      <text class="loading-text">发布中，请稍候...</text>
    </view>
  </view>
</view>