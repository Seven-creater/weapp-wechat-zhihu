# âœ… æ–°ç™»å½•æ–¹æ¡ˆå®ç°å®Œæˆï¼

## ğŸ‰ å·²å®Œæˆçš„å·¥ä½œ

### 1. ç™»å½•é¡µé¢ï¼ˆå®Œæ•´å®ç°ï¼‰
**æ–‡ä»¶ä½ç½®**ï¼š`pages/login/`

âœ… **index.js** - é¡µé¢é€»è¾‘
- å¤´åƒé€‰æ‹©å¤„ç†
- æ˜µç§°è¾“å…¥å¤„ç†
- å¤´åƒä¸Šä¼ åˆ°äº‘å­˜å‚¨
- ç”¨æˆ·ä¿¡æ¯ä¿å­˜
- è¡¨å•éªŒè¯
- è·³è¿‡åŠŸèƒ½

âœ… **index.wxml** - é¡µé¢ç»“æ„
- ä½¿ç”¨ `button` çš„ `open-type="chooseAvatar"`
- ä½¿ç”¨ `input` çš„ `type="nickname"`
- ç¾è§‚çš„UIå¸ƒå±€

âœ… **index.wxss** - é¡µé¢æ ·å¼
- æ¸å˜èƒŒæ™¯
- åœ†å½¢å¤´åƒ
- ç°ä»£åŒ–è®¾è®¡
- å“åº”å¼å¸ƒå±€

âœ… **index.json** - é¡µé¢é…ç½®
- å¯¼èˆªæ é…ç½®

### 2. äº‘å‡½æ•°ï¼ˆ2ä¸ªï¼‰

âœ… **updateUserInfo**
- ä¿å­˜/æ›´æ–°ç”¨æˆ·ä¿¡æ¯
- è‡ªåŠ¨åˆ›å»ºæˆ–æ›´æ–°ç”¨æˆ·è®°å½•
- å‚æ•°éªŒè¯
- é”™è¯¯å¤„ç†

âœ… **getUserInfo**
- è·å–ç”¨æˆ·ä¿¡æ¯
- æ”¯æŒæŸ¥è¯¢æŒ‡å®šç”¨æˆ·
- è¿”å›æ ‡å‡†æ ¼å¼

### 3. æ–‡æ¡£

âœ… **æ–°ç™»å½•æ–¹æ¡ˆå®ç°æŒ‡å—.md**
- å®Œæ•´çš„å®ç°è¯´æ˜
- ä½¿ç”¨æ–¹æ³•
- æ ¸å¿ƒä»£ç ç¤ºä¾‹
- ä¸æ—§æ–¹æ¡ˆå¯¹æ¯”

âœ… **æ–°ç™»å½•æ–¹æ¡ˆä½¿ç”¨ç¤ºä¾‹.js**
- 6ä¸ªå®é™…ä½¿ç”¨ç¤ºä¾‹
- è¦†ç›–å„ç§åœºæ™¯
- å¯ç›´æ¥å¤åˆ¶ä½¿ç”¨

### 4. é…ç½®æ›´æ–°

âœ… **app.json**
- å·²æ³¨å†Œç™»å½•é¡µé¢

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ­¥éª¤1ï¼šéƒ¨ç½²äº‘å‡½æ•°

åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­ï¼š

1. å³é”®ç‚¹å‡» `cloudfunctions/updateUserInfo`
2. é€‰æ‹©"ä¸Šä¼ å¹¶éƒ¨ç½²ï¼šäº‘ç«¯å®‰è£…ä¾èµ–"
3. å¯¹ `getUserInfo` é‡å¤ç›¸åŒæ“ä½œ

### æ­¥éª¤2ï¼šåœ¨éœ€è¦çš„åœ°æ–¹è°ƒç”¨

```javascript
// æ£€æŸ¥æ˜¯å¦éœ€è¦ç™»å½•
const app = getApp();
const userInfo = app.globalData.userInfo || wx.getStorageSync('userInfo');

if (!userInfo || !userInfo.nickName) {
  // è·³è½¬åˆ°ç™»å½•é¡µ
  wx.navigateTo({
    url: '/pages/login/index'
  });
}
```

### æ­¥éª¤3ï¼šæµ‹è¯•

1. ç¼–è¯‘å°ç¨‹åº
2. ç‚¹å‡»éœ€è¦ç™»å½•çš„åŠŸèƒ½
3. è·³è½¬åˆ°ç™»å½•é¡µé¢
4. é€‰æ‹©å¤´åƒå’Œè¾“å…¥æ˜µç§°
5. ç‚¹å‡»"å®Œæˆ"
6. è‡ªåŠ¨è¿”å›å¹¶ä½¿ç”¨ç”¨æˆ·ä¿¡æ¯

---

## ğŸ“± æ ¸å¿ƒç‰¹æ€§

### ç”¨æˆ·ä½“éªŒ
- âœ… **æ— éœ€å¼¹çª—æˆæƒ** - ç¬¦åˆå¾®ä¿¡æœ€æ–°è§„èŒƒ
- âœ… **æµç•…çš„äº¤äº’** - å®æ—¶é¢„è§ˆå’ŒéªŒè¯
- âœ… **æ”¯æŒè·³è¿‡** - ä½¿ç”¨é»˜è®¤ä¿¡æ¯
- âœ… **ç¾è§‚çš„UI** - ç°ä»£åŒ–è®¾è®¡

### æŠ€æœ¯ç‰¹æ€§
- âœ… **è‡ªåŠ¨ä¸Šä¼ å¤´åƒ** - åˆ°äº‘å­˜å‚¨
- âœ… **æ•°æ®æŒä¹…åŒ–** - äº‘æ•°æ®åº“ + æœ¬åœ°ç¼“å­˜
- âœ… **å…¨å±€çŠ¶æ€ç®¡ç†** - app.globalData
- âœ… **é”™è¯¯å¤„ç†** - å®Œå–„çš„å¼‚å¸¸å¤„ç†

### å®‰å…¨æ€§
- âœ… **å‚æ•°éªŒè¯** - æ˜µç§°é•¿åº¦é™åˆ¶
- âœ… **äº‘å‡½æ•°æƒé™** - è‡ªåŠ¨è·å– openid
- âœ… **æ•°æ®åŠ å¯†** - ä½¿ç”¨å¾®ä¿¡äº‘å¼€å‘

---

## ğŸ’¡ ä½¿ç”¨åœºæ™¯

### åœºæ™¯1ï¼šå‘å¸ƒå†…å®¹æ—¶
```javascript
const userInfo = app.globalData.userInfo;
if (!userInfo) {
  wx.navigateTo({ url: '/pages/login/index' });
  return;
}
// ç»§ç»­å‘å¸ƒ...
```

### åœºæ™¯2ï¼šä¸ªäººä¸­å¿ƒ
```javascript
onShow: function() {
  const userInfo = wx.getStorageSync('userInfo');
  if (!userInfo) {
    wx.redirectTo({ url: '/pages/login/index' });
  }
}
```

### åœºæ™¯3ï¼šè¯„è®ºç‚¹èµ
```javascript
handleLike: function() {
  if (!this.checkLogin()) {
    this.guideToLogin();
    return;
  }
  // æ‰§è¡Œç‚¹èµ...
}
```

---

## ğŸ¯ ä¸æ—§æ–¹æ¡ˆå¯¹æ¯”

| ç‰¹æ€§ | æ—§æ–¹æ¡ˆ | æ–°æ–¹æ¡ˆ |
|------|--------|--------|
| æˆæƒæ–¹å¼ | å¼¹çª—æˆæƒ | æ— éœ€å¼¹çª— âœ… |
| ç”¨æˆ·ä½“éªŒ | è¾ƒå·® | ä¼˜ç§€ âœ… |
| å®˜æ–¹æ”¯æŒ | å·²åºŸå¼ƒ âŒ | æ¨èä½¿ç”¨ âœ… |
| å®ç°éš¾åº¦ | ç®€å• | ç®€å• âœ… |
| çµæ´»æ€§ | ä½ | é«˜ âœ… |

---

## ğŸ“Š æ•°æ®æµç¨‹

```
ç”¨æˆ·æ‰“å¼€å°ç¨‹åº
    â†“
æ£€æŸ¥æ˜¯å¦æœ‰ç”¨æˆ·ä¿¡æ¯
    â†“
æ²¡æœ‰ â†’ è·³è½¬ç™»å½•é¡µ
    â†“
é€‰æ‹©å¤´åƒ + è¾“å…¥æ˜µç§°
    â†“
ä¸Šä¼ å¤´åƒåˆ°äº‘å­˜å‚¨
    â†“
è°ƒç”¨äº‘å‡½æ•°ä¿å­˜ä¿¡æ¯
    â†“
æ›´æ–°å…¨å±€çŠ¶æ€å’Œç¼“å­˜
    â†“
è¿”å›åº”ç”¨ç»§ç»­ä½¿ç”¨
```

---

## ğŸ”§ è‡ªå®šä¹‰é…ç½®

### ä¿®æ”¹é»˜è®¤å¤´åƒ
```javascript
// pages/login/index.js
data: {
  avatarUrl: '/images/your-avatar.png',
}
```

### ä¿®æ”¹æ˜µç§°è§„åˆ™
```javascript
// cloudfunctions/updateUserInfo/index.js
if (nickName.length > 20) {
  return { success: false, error: 'æ˜µç§°å¤ªé•¿' };
}
```

### ä¿®æ”¹UIæ ·å¼
```css
/* pages/login/index.wxss */
.container {
  background: linear-gradient(135deg, #your-color1, #your-color2);
}
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [æ–°ç™»å½•æ–¹æ¡ˆå®ç°æŒ‡å—.md](./æ–°ç™»å½•æ–¹æ¡ˆå®ç°æŒ‡å—.md)
- [æ–°ç™»å½•æ–¹æ¡ˆä½¿ç”¨ç¤ºä¾‹.js](./æ–°ç™»å½•æ–¹æ¡ˆä½¿ç”¨ç¤ºä¾‹.js)
- [å¾®ä¿¡å®˜æ–¹æ–‡æ¡£](https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/userProfile.html)

---

## âœ¨ æ€»ç»“

**æ–°ç™»å½•æ–¹æ¡ˆå·²å®Œå…¨å®ç°å¹¶å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼**

ä¸»è¦ä¼˜åŠ¿ï¼š
1. âœ… ç¬¦åˆå¾®ä¿¡æœ€æ–°è§„èŒƒ
2. âœ… ç”¨æˆ·ä½“éªŒä¼˜ç§€
3. âœ… å®ç°ç®€å•æ˜“ç”¨
4. âœ… åŠŸèƒ½å®Œæ•´å¯é 
5. âœ… æ–‡æ¡£è¯¦ç»†æ¸…æ™°

**ç°åœ¨å¯ä»¥åœ¨é¡¹ç›®ä¸­ä½¿ç”¨æ–°çš„ç™»å½•æ–¹æ¡ˆäº†ï¼** ğŸ‰

---

**å®ç°æ—¶é—´**ï¼š2026-01-29  
**çŠ¶æ€**ï¼šâœ… å®Œæ•´å®ç°  
**æµ‹è¯•çŠ¶æ€**ï¼šå¾…æµ‹è¯•  
**å…¼å®¹æ€§**ï¼šå¾®ä¿¡åŸºç¡€åº“ 2.21.2+









